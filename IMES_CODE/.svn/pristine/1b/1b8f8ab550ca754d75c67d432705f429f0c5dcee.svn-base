<%@ Page Language="C#" MasterPageFile="~/MasterPageMaintain.master" AutoEventWireup="true" CodeFile="AlarmMaintain.aspx.cs" Inherits="webroot_UPHMaintain_AlarmMaintain" EnableEventValidation = "false"  Title="Untitled Page" %>
<asp:Content ID="Content1" ContentPlaceHolderID="iMESContent" Runat="Server">
<div>
<div style="position:absolute;left:40%;font-size:xx-large;height:22px">Alarm Maintain</div>
    <table style="height: 305px; width: 600px; position:relative; top:30px; left:30%;"  cellpadding="0">
<tr>
         <td bgcolor="#CCCCCC" >
                <asp:Label ID="Label1" runat="server" Text="制程:" Font-Size="17"></asp:Label>
         </td>
         <td colspan="2" bgcolor="#E7E7E7">
            <asp:DropDownList ID="Process" name="Process" runat="server" Width="353px" 
                 Height="25px" AutoPostBack="True" 
                 onselectedindexchanged="Process_SelectedIndexChanged">
            </asp:DropDownList>
        </td>
        <td style="width: 150px"></td>
</tr>
<tr>
        <td bgcolor="#CCCCCC">
            <asp:Label ID="Label2" runat="server" Text="班次:" Font-Size="17"></asp:Label>
        </td>
        <td colspan="2" bgcolor="#E7E7E7">
            <asp:DropDownList ID="Shift" name="Shift" runat="server" Width="353px" 
                Height="25px" AutoPostBack="True" 
                onselectedindexchanged="Shift_SelectedIndexChanged">
            <asp:ListItem Value="D">白班</asp:ListItem>
            <asp:ListItem Value="N">夜班</asp:ListItem>
            </asp:DropDownList>
        </td>
        <td style="width: 150px"></td>
</tr>
<tr>
        <td bgcolor="#CCCCCC">
            <asp:Label ID="Label3" runat="server" Text="线别:" Font-Size="17"></asp:Label>
        </td>
        <td colspan="2" bgcolor="#E7E7E7">
            <asp:DropDownList ID="PdLine" name="PdLine" runat="server" Width="353px" 
                Height="25px" AutoPostBack="True" 
                onselectedindexchanged="PdLine_SelectedIndexChanged1">
            </asp:DropDownList>
        </td>
        <td style="width: 150px"></td>
</tr>
<tr>
        <td bgcolor="#CCCCCC">
            <asp:Label ID="Label4" runat="server" Text="时间:" Font-Size="17"></asp:Label>
        </td>
        <td colspan="2" bgcolor="#E7E7E7">
            <input runat="server"  name="BeginTime" type="text" 
                style="width:160px;height:20px"   onclick="_SetTime(this)"  id="BeginTime" 
                readonly="readonly"/>&nbsp to
            <input runat="server" name="EndTime" type="text"  
                style="width:160px;height:20px" onclick="_SetTime(this)"   id="EndTime" 
                readonly="readonly"/>
        </td>
        <td style="width: 150px"></td>
</tr>
<tr>
        <td bgcolor="#CCCCCC" >
            <asp:Label ID="Label6" runat="server" Text="类型:" Font-Size="17"></asp:Label>
        </td>
        <td colspan="2" bgcolor="#E7E7E7">
            <asp:DropDownList ID="Status" name="Status" runat="server" Width="353px" Height="25px">
                <asp:ListItem Value="1">上班</asp:ListItem>
                <asp:ListItem Value="1">下班</asp:ListItem>
                <asp:ListItem Value="1">重工</asp:ListItem>
            </asp:DropDownList>
        </td>
        <td style="width: 150px"></td>
</tr>
<tr>
        <td bgcolor="#CCCCCC" style="height: 45px">
        <asp:Label ID="Label7" runat="server" Text="Remark:" Font-Size="15pt" 
            style="font-size: medium"></asp:Label>
            </td>
        <td style="height: 45px" colspan="2" bgcolor="#E7E7E7">
            <textarea  id="Remark" name="Remark" style="height: 35px; width: 347px; resize:none;" maxlength="40"></textarea>
        </td>
        <td style="width: 150px">
            <asp:Button ID="Button_Export" runat="server" onclick="Button_Export_Click" 
                Text="DownExcel" Width="87px" />
        </td>
</tr>
<tr>
        <td width="20%">
            &nbsp;</td>
        <td>
                <asp:Button ID="Button_Maintain" runat="server" Text="Maintain" 
                    onclick="Button_Maintain_Click" />
               
                <asp:Button ID="Button_Delete" runat="server" OnClientClick="return confirm('Are  you  sure?');" onclick="Button_Delete_Click" 
                    Text="Delete" />
               
        </td>
        <td align="left">
                 <asp:Button ID="Button_Quiry" runat="server" Text="Show All" 
                     onclick="Button_Quiry_Click1" />
                 <asp:Button ID="Button_Import" runat="server" OnClientClick="return confirm('上传前请确认excel后缀名为.xls，存放数据的页名为Sheet1，含有空值的数据将不会被上传！');" onclick="Button_Import_Click" 
                     Text="InputExcel" Width="77px" />
        </td>
        <td style="width: 150px">
                 <asp:FileUpload ID="FileUpload1" runat="server" Width="152px" 
                     BackColor="#B871FF" BorderColor="White" BorderStyle="None" />
        </td>
</tr>
</table>
<div style="border: 2px inset #CC0000; position:absolute; top: 344px; left: 8.5%; width:1100px;min-height:0px; max-height:240px ; overflow:auto;">
    <asp:GridView ID="GridView1" runat="server" 
        BackColor="#E6E6E6" BorderColor="#CC9966" 
        BorderWidth="1px" CellPadding="4" BorderStyle="Dotted" Width="100%" 
        EmptyDataText="数据为空！数据已删除或尚未维护相应数据！">
        <RowStyle BackColor="#FFF4F4" ForeColor="#330099"/>
        <EmptyDataRowStyle Font-Size="XX-Large" HorizontalAlign="Center" />
        <Columns>
            <asp:TemplateField>
                <ItemTemplate>
                    <asp:CheckBox ID="CheckBox1" runat="server" BorderColor="#D50000" 
                        BorderStyle="Outset" BorderWidth="2px" BackColor="#FFCAE4" />
                </ItemTemplate>
                <HeaderTemplate>
                    <asp:CheckBox ID="CheckALL" runat="server" AutoPostBack="True" 
                        onclick="javascript: SelectAllCheckboxes(this);" BorderColor="#AB00E3" 
                        BorderStyle="Outset" BorderWidth="2px" BackColor="#8A0000"/>
                </HeaderTemplate>
                <ItemStyle HorizontalAlign="Center" />
            </asp:TemplateField>
        </Columns>
        <FooterStyle BackColor="#FFFFCC" ForeColor="#330099" />
        <PagerStyle BackColor="#FFFFCC" ForeColor="#330099" HorizontalAlign="Center" />
        <SelectedRowStyle BackColor="#FFCC66" Font-Bold="True" ForeColor="#663399" />
        <HeaderStyle BackColor="#990000" Font-Bold="True" ForeColor="#FFFFCC" />
    </asp:GridView>
</div> 
</div>
<script language="javascript">
    var str = "";
    document.writeln("<div id=\"_contents\" style=\"padding:6px; background-color:#9966ff; font-size: 12px; border: 1px solid #777777; position:absolute; left:?px; top:195px; width:?px; height:?px; z-index:1; visibility:hidden\">");
    str += "\u65f6<select id=\"_hour\">";
    for (h = 0; h <= 9; h++) {
        str += "<option value=\"0" + h + "\">0" + h + "</option>";
    }
    for (h = 10; h <= 23; h++) {
        str += "<option value=\"" + h + "\">" + h + "</option>";
    }
    str += "</select> \u5206<select id=\"_minute\">";
    for (m = 0; m <= 9; m++) {
        str += "<option value=\"0" + m + "\">0" + m + "</option>";
    }
    for (m = 10; m <= 59; m++) {
        str += "<option value=\"" + m + "\">" + m + "</option>";
    }
    //    str += "</select> \u79d2<select id=\"_second\">";
    //    for (s = 0; s <= 9; s++) {
    //        str += "<option value=\"0" + s + "\">0" + s + "</option>";
    //    }
    //    for (s = 10; s <= 59; s++) {
    //        str += "<option value=\"" + s + "\">" + s + "</option>";
    //    }
    str += "</select> <input name=\"queding\" type=\"button\" onclick=\"_select()\" value=\"\u786e\u5b9a\" style=\"font-size:12px\" /></div>";
    document.writeln(str);
    var _fieldname;
    function _SetTime(tt) {
        _fieldname = tt;
        var tttt = tt.offsetTop;    //TT控件的定位点高  
        var thei = tt.clientHeight;    //TT控件本身的高
        var tleft = "43%";    //TT控件的定位点宽
        var ttop;
        //        while (tttt = tt.offsetParent) {
        //            ttop += tt.offsetTop;
        //            tleft += tt.offsetLeft;
        //        }
        document.getElementById("_contents").style.top = tttt + thei + 4;
        document.getElementById("_contents").style.left = tleft;
        document.getElementById("_contents").style.visibility = "visible";
    }
    function _select() {
        _fieldname.value = document.getElementById("_hour").value + ":" + document.getElementById("_minute").value /*+ ":" + document.getElementById("_second").value*/;
        document.getElementById("_contents").style.visibility = "hidden";
    }

//全选提示框
    function SelectAllCheckboxes(spanChk) {
        if (confirm("确认全选或取消全选？")) {
            elm = document.forms[0];
            for (i = 0; i <= elm.length - 1; i++) {
                if (elm[i].type == "checkbox" && elm[i].id != spanChk.id) {
                    if (elm.elements[i].checked != spanChk.checked) {
                        elm.elements[i].checked = spanChk.checked;
                    }
                }
            }
        }
        else {
            if (spanChk.checked == true) { spanChk.checked = false; }
            else {spanChk.checked = true; }
        }
    }
</script> 
</asp:Content>

